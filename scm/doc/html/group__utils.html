<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<title>GMTB Single Column Model: gmtb_scm_utils</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="dtc_logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GMTB Single Column Model
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__utils.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">gmtb_scm_utils<div class="ingroups"><a class="el" href="group___s_c_m.html">GMTB Single Column Model</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains miscellaneous helper subroutines.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ga71de1dc39c1fd3d956cd6aaf5ed91c38"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga71de1dc39c1fd3d956cd6aaf5ed91c38"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>gmtb_scm_utils::w_to_omega</b> (n_col, n_lev, w, p, T, omega)</td></tr>
<tr class="separator:ga71de1dc39c1fd3d956cd6aaf5ed91c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb63e1dee42e85425c1a636a6b5449b0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utils.html#gabb63e1dee42e85425c1a636a6b5449b0">gmtb_scm_utils::copy_data_to_working_dir</a> (dir_name)</td></tr>
<tr class="memdesc:gabb63e1dee42e85425c1a636a6b5449b0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to copy data needed by the main program to the working directory.  <a href="group__utils.html#gabb63e1dee42e85425c1a636a6b5449b0">More...</a><br /></td></tr>
<tr class="separator:gabb63e1dee42e85425c1a636a6b5449b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga86425fa83391b0ce1719fa1def3d46e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utils.html#ga86425fa83391b0ce1719fa1def3d46e5">gmtb_scm_utils::remove_data_from_working_dir</a> ()</td></tr>
<tr class="memdesc:ga86425fa83391b0ce1719fa1def3d46e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to remove data needed by the main program from the working directory.  <a href="group__utils.html#ga86425fa83391b0ce1719fa1def3d46e5">More...</a><br /></td></tr>
<tr class="separator:ga86425fa83391b0ce1719fa1def3d46e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadaa5d6afea19af5a67f29f4cde5a94af"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__utils.html#gadaa5d6afea19af5a67f29f4cde5a94af">gmtb_scm_utils::interpolate_to_grid_centers</a> (n_input_levels, input_pres, input_field, pres_l, n_model_levels, model_field,   last_initialized)</td></tr>
<tr class="memdesc:gadaa5d6afea19af5a67f29f4cde5a94af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine to interpolate a generic input field to the model vertical grid. The index of the last model level initialized is returned so that the calling procedure can patch in a reference profile above.  <a href="group__utils.html#gadaa5d6afea19af5a67f29f4cde5a94af">More...</a><br /></td></tr>
<tr class="separator:gadaa5d6afea19af5a67f29f4cde5a94af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains miscellaneous helper subroutines. </p>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="gabb63e1dee42e85425c1a636a6b5449b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gmtb_scm_utils::copy_data_to_working_dir </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>dir_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to copy data needed by the main program to the working directory. </p>
<p>The GFS radiation code requires files containing aerosol, CO2, and solar constant data to be in the working directory at runtime. This subroutine temporarily copies the data to the working directory to be removed after the SCM runs.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">dir_name</td><td>the directory where the data is located </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="gmtb__scm__utils_8f90_source.html#l00024">24</a> of file <a class="el" href="gmtb__scm__utils_8f90_source.html">gmtb_scm_utils.f90</a>.</p>

<p>Referenced by <a class="el" href="gmtb__scm_8f90_source.html#l00031">gmtb_scm_main::gmtb_scm_main_sub()</a>.</p>

</div>
</div>
<a class="anchor" id="gadaa5d6afea19af5a67f29f4cde5a94af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gmtb_scm_utils::interpolate_to_grid_centers </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_input_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>input_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>input_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>pres_l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>n_model_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=dp), dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>model_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>last_initialized</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to interpolate a generic input field to the model vertical grid. The index of the last model level initialized is returned so that the calling procedure can patch in a reference profile above. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_input_levels</td><td>number of levels in the input profile</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_model_levels</td><td>number of model levels</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_pres</td><td>pressure levels for the input profile (Pa)</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input_field</td><td>data from the input profile</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pres_l</td><td>model pressure levels (Pa)</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">model_field</td><td>interpolated model data profile</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">last_initialized</td><td>last vertical model index that was properly initialized </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000015">Todo:</a></b></dt><dd>Given the exponential decrease in pressure, this routine should probably be converted to using a different method of interpolation (rather tha linear). </dd></dl>
<h1><a class="anchor" id="interpolate_to_grid_centers_alg"></a>
Algorithm</h1>
<ul>
<li>Find level where input_pres &lt; pres_l(i)</li>
<li>Once found, calculate the linear interpolation fraction.</li>
<li>Calculate the model field at level i using linear interpolation.</li>
<li>If no level is found, the input sounding does not reach to top of model domain; return the index of the last level initialized.</li>
</ul>

<p>Definition at line <a class="el" href="gmtb__scm__utils_8f90_source.html#l00040">40</a> of file <a class="el" href="gmtb__scm__utils_8f90_source.html">gmtb_scm_utils.f90</a>.</p>

<p>Referenced by <a class="el" href="gmtb__scm__forcing_8f90_source.html#l00028">gmtb_scm_forcing::interpolate_forcing()</a>, and <a class="el" href="gmtb__scm__setup_8f90_source.html#l00026">gmtb_scm_setup::set_state()</a>.</p>

</div>
</div>
<a class="anchor" id="ga86425fa83391b0ce1719fa1def3d46e5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine gmtb_scm_utils::remove_data_from_working_dir </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Subroutine to remove data needed by the main program from the working directory. </p>
<p>This subroutine deletes the data that was temporarily copied to the working directory for file cleanliness. </p>

<p>Definition at line <a class="el" href="gmtb__scm__utils_8f90_source.html#l00033">33</a> of file <a class="el" href="gmtb__scm__utils_8f90_source.html">gmtb_scm_utils.f90</a>.</p>

<p>Referenced by <a class="el" href="gmtb__scm_8f90_source.html#l00031">gmtb_scm_main::gmtb_scm_main_sub()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
